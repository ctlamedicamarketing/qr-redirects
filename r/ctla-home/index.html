<!doctype html>
<html lang="en">
<meta charset="utf-8">
<title>Redirecting…</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="noindex, nofollow">

<!-- Canonical = final destination to avoid SEO weirdness -->
<link rel="canonical" href="https://ctlamedica.com">

<!-- Cache nudges (not guaranteed, but helps on GH Pages) -->
<meta http-equiv="Cache-Control" content="no-store, max-age=0, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">

<!-- Immediate meta refresh fallback -->
<meta http-equiv="refresh" content="0;url=https://ctlamedica.com">

<style>
  body { font: 16px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 2rem; }
  .hint { opacity:.7; font-size:.875rem; }
</style>

<main>
  <h1>Redirecting…</h1>
  <p>If you’re not redirected automatically, <a id="link" href="https://ctlamedica.com" rel="external nofollow noopener">click here</a>.</p>
  <p class="hint">UTM parameters and #hash anchors are preserved for analytics and deep links.</p>
</main>

<script>
(function () {
  // ---- KNOBS ---------------------------------------------------------------
  var DEST = "https://ctlamedica.com"; // <-- change this when you repoint
  // Leave ALLOW_PARAMS empty to pass ALL params through.
  var ALLOW_PARAMS = ["utm_source","utm_medium","utm_campaign","utm_term","utm_content","gclid","fbclid"];

  var ADD_CACHE_BUSTER = true;  // set false to stop adding _r= timestamp
  // -------------------------------------------------------------------------

  function safeURL(href) {
    try { return new URL(href); }
    catch (e) {
      var a = document.createElement('a');
      a.href = href;
      var sp = new URLSearchParams((a.search||"").replace(/^\?/, ""));
      return {
        origin: a.protocol + "//" + a.host,
        pathname: a.pathname,
        search: a.search,
        hash: a.hash,
        searchParams: sp,
        toString: function(){ return this.origin + this.pathname + (this.searchParams.toString() ? "?"+this.searchParams : "") + (this.hash||""); }
      };
    }
  }

  var target = safeURL(DEST);
  var incoming = safeURL(window.location.href);

  // Merge whitelisted query params (or all, if allow-list empty)
  incoming.searchParams.forEach(function (v, k) {
    if (!ALLOW_PARAMS.length || ALLOW_PARAMS.indexOf(k) !== -1) {
      // Use set() to avoid duplicates if DEST already includes the same key
      if (typeof target.searchParams.set === "function") target.searchParams.set(k, v);
      else { target.searchParams.delete(k); target.searchParams.append(k, v); }
    }
  });

  // Preserve #hash anchors (incoming hash wins)
  if (incoming.hash) target.hash = incoming.hash;

  // Optional cache-buster
  if (ADD_CACHE_BUSTER) {
    var ts = Date.now().toString(36);
    if (typeof target.searchParams.set === "function") target.searchParams.set("_r", ts);
    else target.searchParams.append("_r", ts);
  }

  // Update fallback link so users without JS still see the right target
  var link = document.getElementById("link");
  if (link) link.href = target.toString();

  // Optional private analytics ping (disabled by default)
  // try { navigator.sendBeacon && navigator.sendBeacon("https://example.com/qr-ping", JSON.stringify({slug: location.pathname, t: Date.now()})); } catch(e){}

  // Redirect without adding a history entry
  location.replace(target.toString());
})();
</script>

<noscript>
  <meta http-equiv="refresh" content="0;url=https://ctlamedica.com">
  <p>If you’re not redirected automatically, <a href="https://ctlamedica.com" rel="external nofollow noopener">click here</a>.</p>
</noscript>
</html>

